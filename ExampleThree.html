<!DOCTYPE html>
<html>
<head>
	<script src = "https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
</head>
<body>
	<script>
		var config = {
			type: Phaser.AUTO,
			width: 800, // Width of the game screen.
			height: 600, // Height of the game screen.
			backgroundColor: '#0072bc', // Background colour (Blue).
			physics: { // Physics to use
				default: 'arcade',
				arcade:{
					gravity: {y: 0}
				}
			},
			scene:{ // Functions to use in the scene.
				preload: preload,
				create: create,
				update: update
			}
		};

		var player; // Player.
		var cursors; // Cursor keys variable (Up, Down, Left, Right).
		var spacebar;
		var bullets;
		var game = new Phaser.Game(config); // Game instance.

		function preload()
		{
			this.load.image('block', 'assets/textures/block.jpg'); // Preload the block image.
			this.load.image('bullet', 'assets/textures/particle.png');
		}

		function create()
		{
			cursors = this.input.keyboard.createCursorKeys(); // Create the cursor keys.
			player = this.physics.add.image(400, 300, 'block'); // Add the block into the world.
			player.setCollideWorldBounds(true); // Set the collision of the block to true.

			var Bullet = new Phaser.Class({
				Extends: Phaser.GameObjects.Image,
				initialize:
				function Bullet(scene)
				{
					Phaser.GameObjects.Image.call(this, scene, 0, 0, 'bullet');
					this.scaleX = 0.25;
					this.scaleY = 0.25;
					this.speed = Phaser.Math.GetSpeed(600, 1);
				},

				fire: function(x, y)
				{
					this.setPosition(x, y);
					this.setActive(true);
					this.setVisible(true);
				},

				update: function(time, delta)
				{
					this.x += this.speed * delta;
					if(this.x > 820)
					{
						this.setActive(false);
						this.setVisible(false);
					}
				}
			});

			bullets = this.add.group({
				classType: Bullet,
				maxSize: 30,
				runChildUpdate: true
			});


			spacebar = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);

		}

		function update()
		{
			player.setVelocity(0); // If nothing is pressed don't add any velocity to the player.
    		if (cursors.left.isDown) // Left input
    		{
    	  		player.setVelocityX(-300);
   			}
    		else if (cursors.right.isDown) // Right input
    		{
    	    	player.setVelocityX(300);
   	 		}

    		if (cursors.up.isDown) // Down input
    		{
        		player.setVelocityY(-300);
    		}
    		else if (cursors.down.isDown) // Up input
    		{
        		player.setVelocityY(300);
    		}

    		if(Phaser.Input.Keyboard.JustDown(spacebar))
    		{
    			var bullet = bullets.get();
    			if(bullet)
    			{
    				bullet.fire(player.x, player.y);
    			}
    		}

		}

	</script>
</body>
</html>